<!--
GENERATED FILE - DO NOT EDIT
This file was generated by [MarkdownSnippets](https://github.com/SimonCropp/MarkdownSnippets).
Source File: /pages/mdsource/upgradeGuideV5.source.md
To change this file edit the source file and then run MarkdownSnippets.
-->

# Version 5 upgrade guide


## Consumers

Fody now requires MSBuild16.

This means any tool chain being used needs to support MSBuild16. For example:

 * Visual Studio 19.
 * [dotnet core SDK 2.2](https://dotnet.microsoft.com/download/dotnet-core/2.2).
 * JetBrains Rider 2018.3.4.

To ensure all consumers are using the correct build tooling, ensure the `.sln` file starts with:

```
Microsoft Visual Studio Solution File, Format Version 12.00
# Visual Studio Version 16
VisualStudioVersion = 16.0.28721.148
MinimumVisualStudioVersion = 16.0.28721.148
```


### Build server

To use MSBuild install [Build Tools for Visual Studio 2019](https://visualstudio.microsoft.com/downloads/#vstool-2019). To use dotnet build install the current [dotnet core SDK](https://dotnet.microsoft.com/download/dotnet-core/2.2).


#### AppVeyor

At this time AppVeyor does not support the RTM of Visual Studio 2019. However the [Visual Studio 2019 preview image](https://www.appveyor.com/docs/build-environment/#visual-studio-preview-images) can be used via `image: Visual Studio 2019 Preview` in `appveyor.yml`.


#### TravisCI

MSBuild16 can be used on TravisCI using the [xenial distro](https://docs.travis-ci.com/user/reference/xenial/) and [dotnet 2.2.202](https://docs.travis-ci.com/user/languages/csharp/#net-core). An example `.travis.yml` config:

```
language: csharp
dist: xenial
sudo: required
mono: none
dotnet: 2.2.202
script:
  - dotnet build /p:Configuration=Release /p:Platform="Any CPU" --framework netcoreapp2.2
  - dotnet test --no-build --configuration Release --framework netcoreapp2.2
```


### mdb symbols no longer supported

Move over to pdb symbols or embedded symbols.


### Update NuGet

Update to Version 5 of the [Fody NuGet package](https://www.nuget.org/packages/Fody/).


## Weavers

The following steps are only required for people creating Fody Weavers.

This also applies to [in solution weaving](in-solution-weaving.md).

**Weavers targeting Version 4 of Fody are compatible with Version 5.**


### Update to MSBuild16

As outlined above in the Consumers section


### Update the weaver project to be only netstandard2.0

Weavers projects (`Name.Fody.csproj`) now only need to target netstandard2.0. So change `<TargetFrameworks>net46;netstandard2.0</TargetFrameworks>` to `<TargetFramework>netstandard2.0</TargetFramework>`.


### Update test project to a compatible framework

Fody now requires net472 at build time, so the test project (usually `Name.Fody.Test.csproj` or `Test.csproj`) needs to be changed to compatible frameworks. Usually this means changing `<TargetFrameworks>net46;netcoreapp2.2</TargetFrameworks>` to `<TargetFrameworks>net472;netcoreapp2.2</TargetFrameworks>`.


### Ensure correct build order

MSBuild16 now properly supports project build order dependencies. See [Addin Development - Build Order](addin-development.md#build-order).


### Update NuGet packages

Update to Version 5 of the `Fody`, `FodyHelpers`, and `FodyPackaging` NuGet packages.
